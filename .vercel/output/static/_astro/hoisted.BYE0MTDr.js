import{n as c}from"./router.B7bwGQeM.js";import"./hoisted.BKaW4cVd.js";document.addEventListener("astro:page-load",y=>{const d=document.querySelector("#add-form");let i=document.querySelector("#email"),u=document.querySelector("#username"),m=document.querySelector("#firstName"),v=document.querySelector("#lastName"),h=document.querySelector("#password"),f=document.querySelector("#phone"),E=document.querySelector("#alternativePhone"),a="";const r=document.getElementById("addBtn"),s=document.getElementById("updateBtn"),l=document.getElementById("backBtn");r.addEventListener("click",async o=>{o.preventDefault();const n=new FormData(d),t=Object.fromEntries(n);console.log(t);try{const e=await fetch("/api/addUser.json/",{method:"POST",body:JSON.stringify(t)}),p=await e.json();if(!e.ok)throw new Error(p);c("/usuarios"),console.log(e)}catch(e){console.log(e)}}),document.querySelectorAll("[data-delete]").forEach(o=>{o.addEventListener("click",n=>{if(a=n.target?.id,!a)return console.log("No se encontro el id");fetch(`/api/${a}.json/`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error("No se pudo realizar la peticion a la DB");c("/usuarios")})})}),document.querySelectorAll("#btnEdit").forEach(o=>{o.addEventListener("click",async n=>{if(r.classList.add("hidden"),s.classList.remove("hidden"),l.classList.remove("hidden"),a=n.target?.dataset.edit??"",!a)return console.log("No se encontro el id");try{const t=await fetch(`/api/${a}.json/`,{method:"GET"}),e=await t.json();if(m.value=e[0].firstName,v.value=e[0].lastName,u.value=e[0].username,i.value=e[0].email,h.value=e[0].password,f.value=e[0].phone,E.value=e[0].alternativePhone,!t.ok)throw new Error("No se pudo realizar la peticion a la DB")}catch(t){console.log(t)}})}),l.addEventListener("click",o=>{r.classList.remove("hidden"),s.classList.add("hidden"),l.classList.add("hidden"),m.value="",v.value="",u.value="",i.value="",h.value="",f.value="",E.value=""}),s.addEventListener("click",async o=>{o.preventDefault();const n=new FormData(d),t=Object.fromEntries(n);try{const e=await fetch(`/api/${a}.json/`,{method:"PATCH",body:JSON.stringify(t)});if(!e.ok)throw new Error("No se pudo realizar la peticion a la DB");c("/usuarios"),console.log(e)}catch(e){console.log(e)}})});
